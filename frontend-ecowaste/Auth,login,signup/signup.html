<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Sign Up - EcoWaste</title>
  <link rel="stylesheet" href="auth-style.css">
  <script src="../js/auth.js"></script>
  <style>.server-message{display:none}</style>
</head>
<body class="auth-body">
  <div class="logo-section"><div class="logo">EcoWaste Management</div></div>
  <div class="auth-container">
    <h1>Create Account</h1>
    <form id="signupForm">
      <div class="form-group"><label for="name">Name</label><input id="name" required></div>
      <div class="form-group"><label for="email">Email</label><input id="email" type="email" required></div>
      <div class="form-group"><label for="password">Password</label><input id="password" type="password" required></div>
      <button type="submit">Sign Up</button>
    </form>
    <p id="msg"></p>
  </div>
  <script src="../js/config.js"></script>
  <script src="../js/api.js"></script>
  <script>
    document.getElementById('signupForm').addEventListener('submit', async function(e){
      e.preventDefault();
      const name = document.getElementById('name').value.trim();
      const email = document.getElementById('email').value.trim();
      const password = document.getElementById('password').value.trim();
      if (!name || !email || !password) { alert('Please fill all fields'); return; }

      if (window.__BACKEND_BASE_URL__) {
        try {
          const res = await EcoApi.signup({name,email,password});
          if (res && (res.success || res.ok)) {
            document.getElementById('msg').textContent = 'Account created. Redirecting to login...';
            setTimeout(()=> window.location.href='login.html', 1000);
            return;
          } else {
            document.getElementById('msg').textContent = res.message || 'Signup failed';
            return;
          }
        } catch(err){ document.getElementById('msg').textContent = 'Error: ' + err.message; return; }
      }

      // Demo fallback
      document.getElementById('msg').textContent = 'Account created (demo). Redirecting to login...';
      setTimeout(()=> window.location.href='login.html', 1200);
    });
  </script>
</body>
</html>
